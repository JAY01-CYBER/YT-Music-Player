name: Build YT Music Player

on:
  release:
    types: [published]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        
    - name: Create package-lock.json
      run: |
        cat > package-lock.json << 'EOF'
        {
          "name": "yt-music-player",
          "version": "1.0.0",
          "lockfileVersion": 2,
          "requires": true,
          "packages": {
            "": {
              "name": "yt-music-player",
              "version": "1.0.0",
              "dependencies": {
                "expo": "~49.0.0",
                "react": "18.2.0",
                "react-native": "0.72.0"
              }
            }
          }
        }
        EOF
        
    - name: Create App Package
      run: |
        mkdir -p YT-Music-App
        echo "🎵 YT Music Player" > YT-Music-App/App-Name.txt
        echo "Version: 1.0.0" >> YT-Music-App/App-Name.txt
        echo "Build Date: $(date)" >> YT-Music-App/App-Name.txt
        
        cat > YT-Music-App/How-To-Run.txt << 'EOF'
        🚀 HOW TO RUN THIS APP:
        
        EASY METHOD (Recommended):
        1. Install 'Expo Go' app from Play Store
        2. Install 'Termux' app from Play Store  
        3. Open Termux and run these commands:
           pkg update && pkg install nodejs git -y
           cd /sdcard
           git clone https://github.com/JAY01-CY/YT-Music-Player
           cd YT-Music-Player
           npm install
           npx expo start
        4. Use Expo Go app to scan QR code
        5. App will open on your phone!
        
        FEATURES:
        ✅ Search any song on YouTube
        ✅ Popular Hindi songs collection
        ✅ Beautiful UI
        ✅ 100% Free
        
        Made with ❤️
        EOF
        
    - name: Upload App Package
      uses: actions/upload-artifact@v4
      with:
        name: YT-Music-Player
        path: YT-Music-App/
        retention-days: 30